---
title: "Untitled"
author: "Vyom Patel"
date: "23/10/2020"
output: pdf_document
---

```{r}
# install.packages("speedglm")
library(tidyverse) # metapackage of all tidyverse packages
library(MASS)
library(boot)
library(speedglm)
library(readr)

fix_names <- function(df) {
    names(df) <- gsub('-', '_', names(df))
    df
}


train_features <- read_csv("/home/patel/Downloads/lish-moa/train_features.csv") %>% fix_names
train_scores <- read_csv("/home/patel/Downloads/lish-moa/train_targets_scored.csv") %>% fix_names
test_features <- read_csv("/home/patel/Downloads/lish-moa/test_features.csv")%>% fix_names
sample <- read_csv("/home/patel/Downloads/lish-moa/sample_submission.csv") %>% fix_names

train = 1:20000

train_x<-train_features[train,] %>% dplyr::select(-sig_id, -cp_type, -cp_time, -cp_dose)
test_x<-train_features[-train,] %>% dplyr::select(-sig_id, -cp_type, -cp_time, -cp_dose)

train_y<-train_scores[train,]%>% dplyr::select(-sig_id)
test_y<-train_scores[-train,]%>% dplyr::select(-sig_id)
t<-test_y %>% dplyr::select(nfkb_inhibitor) 
```

```{r}
glm_fit<-lda(train_y$nfkb_inhibitor~ .,data = data.frame(train_x))
summary(glm_fit)
```

```{r}
pred <- predict(glm_fit,newdata=test_x)$class %>% as.numeric() - 1

t<- t %>%unlist()
#pred[abs(pred) <= .Machine$double.eps * 2] <- 0
x<-t*log(pred) + (1-t)*log(1-pred)
mean(as.matrix(x))
```